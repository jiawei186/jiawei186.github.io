<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="风物长宜放眼量">
<meta property="og:type" content="website">
<meta property="og:title" content="冰雹2009">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="冰雹2009">
<meta property="og:description" content="风物长宜放眼量">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="黄嘉玮">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>冰雹2009</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">冰雹2009</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">微信号: qq3283110</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section">Home</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section">Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section">Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/05/Assembly-language-based-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="黄嘉玮">
      <meta itemprop="description" content="风物长宜放眼量">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰雹2009">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/05/Assembly-language-based-1/" class="post-title-link" itemprop="url">Assembly-language-based-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-05 20:05:43" itemprop="dateCreated datePublished" datetime="2021-03-05T20:05:43+08:00">2021-03-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Embedded-system/" itemprop="url" rel="index"><span itemprop="name">Embedded-system</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="assembly-language-based-1"><a class="markdownIt-Anchor" href="#assembly-language-based-1"></a> Assembly-language-based-1</h1>
<h2 id="1-硬件"><a class="markdownIt-Anchor" href="#1-硬件"></a> 1 硬件</h2>
<p>计算机包含<strong>硬件</strong>和<strong>软件</strong>两大部分</p>
<p><strong>硬件</strong>, <strong>Hardware</strong><br />
硬件是指构成计算机的物理设备, 是人类能摸得着的物体</p>
<p><strong>软件</strong>, <strong>Software</strong><br />
软件是指在物理设备上运行的程序, 是指示物理设备工作的命令, 人类摸不着</p>
<p><strong>微型计算机</strong>, <strong>Microcomputer</strong>, <strong>微机</strong><br />
微型计算机是体积较小和重量较轻的计算机<br />
最常见的微型计算机即是我们平时见到的个人计算机</p>
<p>本文采用<strong>Intel8086处理器</strong>作为例子<br />
美国Intel公司, 以它的8086处理器为基础, 研发出了一系列的处理器<br />
这一系列基于8086处理器的处理器, 被称为<strong>80x86系列处理器</strong></p>
<p><strong>冯诺依曼体系计算机硬件</strong><br />
基于冯诺依曼设计思想的计算机有<strong>5</strong>大部件–<strong>控制器</strong>, <strong>运算器</strong>, <strong>存储器</strong>, <strong>输入设备</strong>, <strong>输出设备</strong></p>
<p><strong>控制器</strong><br />
控制器是整个计算机的控制核心</p>
<p>控制器中包括<strong>存储管理单元</strong>, <strong>代码保护机制单元</strong>等等</p>
<p><strong>运算器</strong><br />
运算器是对数据进行运算处理的部件</p>
<p>运算器中必然有基本的<strong>整数运算器</strong><br />
可能有<strong>浮点处理单元</strong>, <strong>多媒体数据运算单元</strong></p>
<p><strong>存储器</strong><br />
存储器是用来存放数据和程序的部件</p>
<p><strong>输入设备</strong><br />
输入设备将数据和程序变换成计算机内部所能识别和接受的信息方法, 并把它们送入存储器中</p>
<p><strong>输出设备</strong><br />
输出设备将计算机处理的结果一人们能接受的或其他机器能接受的形式送出</p>
<h3 id="11-处理器"><a class="markdownIt-Anchor" href="#11-处理器"></a> 1.1 处理器</h3>
<p>随着时代的发展, 5大部件被排列组合成了<strong>3</strong>个硬件子系统</p>
<p><strong>处理器</strong>, <strong>Processor</strong>, <strong>中央处理单元</strong>, <strong>CPU</strong>, <strong>Central Processing Unit</strong><br />
处理器是一块大规模集成电路芯片, 上面部署着<strong>运算器</strong>, <strong>控制器</strong>, <strong>寄存器</strong></p>
<p>处理器是计算机的运算和控制核心<br />
处理器及其支持电路构成了计算机系统的处理和控制中心, 对系统的各个部件进行统一的协调和控制</p>
<p>微机中的处理器被称为<strong>微处理器</strong>, <strong>Microprocessor</strong><br />
人们常常将微处理器简称为处理器</p>
<h3 id="12-存储系统"><a class="markdownIt-Anchor" href="#12-存储系统"></a> 1.2 存储系统</h3>
<p><strong>存储系统</strong><br />
存储系统由<strong>寄存器</strong>, <strong>高速缓冲存储器</strong>, <strong>主板上的主存储器</strong>, <strong>作为外部设备的辅助存储器</strong>组成</p>
<p><strong>可读可写存储器</strong>, <strong>Random Access Memory</strong>, <strong>RAM</strong>, <strong>半导体存储器</strong><br />
RAM由半导体构成<br />
RAM能<strong>随机存取</strong><br />
RAM中的信息<strong>断电丢失</strong></p>
<p><strong>只读存储器</strong>, <strong>Read Only Memory</strong>, <strong>ROM</strong><br />
RAM可以是由磁盘构成, 也可以是其他构成<br />
ROM只能<strong>顺序存取</strong><br />
ROM中的信息<strong>断电保存</strong></p>
<h3 id="13-输入输出系统"><a class="markdownIt-Anchor" href="#13-输入输出系统"></a> 1.3 输入输出系统</h3>
<p><strong>输入输出系统</strong><br />
输入输出系统由<strong>输入设备</strong>, <strong>输出设备</strong>, <strong>I/O接口电路</strong>组成</p>
<p>处理器和存储系统在信息处理中起主要作用, 是计算机硬件的主体部分, 合在一起被称为<strong>主机</strong></p>
<p><strong>外部设备</strong>, <strong>外围设备</strong>, <strong>外设</strong>, <strong>I/O设备</strong><br />
输入设备和输出设备统称为外部设备<br />
外设的作用是让用户和计算机实现交互</p>
<p><strong>标准输入设备</strong><br />
标准输入设备是键盘</p>
<p><strong>标准输出设备</strong><br />
标准输出设备是显示器</p>
<p><strong>控制台</strong>, <strong>Console</strong><br />
键盘和显示器合成控制台</p>
<p><strong>磁盘驱动器</strong><br />
磁盘驱动器是外部存储的驱动装置<br />
既是输出设备, 又是输入设备</p>
<h2 id="2-软件"><a class="markdownIt-Anchor" href="#2-软件"></a> 2 软件</h2>
<p>计算机中的软件分为<strong>系统软件</strong>和<strong>应用软件</strong></p>
<h3 id="21-系统软件"><a class="markdownIt-Anchor" href="#21-系统软件"></a> 2.1 系统软件</h3>
<p>系统软件的作用是方便使用, 维护和管理计算机系统中的程序和文档</p>
<p><strong>操作系统</strong>, <strong>Operating System</strong>, <strong>OS</strong><br />
操作系统是典型的系统软件<br />
操作系统管理着系统的软硬件资源<br />
操作系统的作用是为用户提供使用机器的交互界面, 为程序员使用资源提供可供调用的驱动程序, 为其他程序构建稳定的运行平台</p>
<p><strong>编译器</strong><br />
编译器也是一种系统软件<br />
编译器的作用是将<strong>高级语言程序</strong>&quot;翻译&quot;为<strong>低级语言程序</strong>, 以便计算机能运行</p>
<h3 id="22-应用软件"><a class="markdownIt-Anchor" href="#22-应用软件"></a> 2.2 应用软件</h3>
<p>应用软件是解决某个问题的程序及其文档, 大到用于处理某专业领域问题的程序, 小到完成一个非常具体工作的程序<br />
应用软件覆盖了计算机应用的所有方面, 每个应用都需要相应的应用程序</p>
<h2 id="3-程序设计语言"><a class="markdownIt-Anchor" href="#3-程序设计语言"></a> 3 程序设计语言</h2>
<p>程序设计语言是<strong>程序员</strong>用来编写程序的语言<br />
程序设计语言是人类和计算机交流的工具</p>
<h3 id="31-机器语言"><a class="markdownIt-Anchor" href="#31-机器语言"></a> 3.1 机器语言</h3>
<p>计算机能直接识别并执行机器指令</p>
<p><strong>机器指令</strong><br />
指令是控制计算机操作的命令<br />
机器指令, 即特定的排列组合的0和1的代码</p>
<p><strong>指令系统</strong>, <strong>指令集</strong>, <strong>Instruction Set</strong><br />
某处理器支持的所有指令的集合就是该处理器的指令集</p>
<p>每种处理器都有各自的机器指令</p>
<p><strong>机器语言</strong>, <strong>Machine Language</strong><br />
指令集及使用它们编写程序的规则, 组合构成了机器语言</p>
<p>常用<strong>十六进制数字</strong>来表示机器语言的<strong>二进制数字</strong><br />
在二进制数字, 加后缀<code>b</code>或<code>B</code>来区分<br />
在十六进制数字, 加后缀<code>h</code>或<code>H</code>来区分, 或者加前缀<code>0x</code>来区分</p>
<p><strong>机器语言程序</strong>, <strong>目标程序</strong>, <strong>目的程序</strong><br />
目标程序, 即用机器语言写成的程序<br />
因为目标程序是唯一一种能被计算机直接执行的程序</p>
<h3 id="32-汇编语言"><a class="markdownIt-Anchor" href="#32-汇编语言"></a> 3.2 汇编语言</h3>
<p>机器语言非常难以读懂和编写, 所以人类基于机器语言创造出了<strong>汇编语言</strong></p>
<p><strong>指令助记符</strong>, <strong>助记符</strong>, <strong>Mnemonic</strong><br />
助记符, 即表示指令功能的符号<br />
助记符一般采用英语单词及其缩写</p>
<p><strong>指令操作数</strong><br />
指令操作数同样采用易于记忆的符号</p>
<p><strong>汇编格式指令</strong><br />
用助记符表示的指令, 即汇编格式指令</p>
<p><strong>汇编语言</strong>, <strong>Assembly Language</strong><br />
汇编格式指令以及使用它们编写程序的规则, 组合构成了汇编语言</p>
<p><strong>汇编程序</strong>, <strong>低级语言</strong>, <strong>低层语言</strong>, <strong>Low Level Language</strong><br />
由汇编语言写成的程序, 即为汇编程序</p>
<p><strong>汇编</strong><br />
汇编语言翻译成机器语言的过程, 被称为汇编</p>
<p><strong>汇编程序</strong>, <strong>Assembler</strong><br />
汇编程序本身就是一个程序<br />
汇编程序将汇编程序, 转化为目标程序</p>
<h3 id="33-高级语言"><a class="markdownIt-Anchor" href="#33-高级语言"></a> 3.3 高级语言</h3>
<p>汇编语言仍然很难懂, 所以人类发明了<strong>高级程序设计语言</strong></p>
<p>高级程序设计语言的语法规则, 非常接近<strong>英语</strong>, 易于掌握</p>
<p>常见的高级语言有<code>JAVA</code>, <code>C/C++</code>, <code>Python</code>等</p>
<p><strong>高级语言程序</strong>被<strong>编译</strong>成<strong>机器语言程序</strong></p>
<p><strong>编译器</strong><br />
编译器, 即将高级语言程序编译成机器语言程序的软件</p>
<table>
<thead>
<tr>
<th>汇编语言</th>
<th>高级语言</th>
</tr>
</thead>
<tbody>
<tr>
<td>与处理器密切相关, 不同的处理器所对应的汇编语言各不相同</td>
<td>与具体计算机无关, 高级语言程序可以在多种计算机上编译后执行</td>
</tr>
<tr>
<td>编写困难</td>
<td>采用类似自然语言的语法, 容易被掌握和应用</td>
</tr>
<tr>
<td>容易写出运行速度快, 指令少的高效率目标程序</td>
<td>容易写出运行速度慢, 指令多的低效率目标程序</td>
</tr>
</tbody>
</table>
<h2 id="4-8086处理器"><a class="markdownIt-Anchor" href="#4-8086处理器"></a> 4 8086处理器</h2>
<p>8086分为<strong>执行单元EU</strong>模块和<strong>总线接口单元BIU</strong>模块</p>
<h3 id="41-总线接口单元biu-bus-interface-unit"><a class="markdownIt-Anchor" href="#41-总线接口单元biu-bus-interface-unit"></a> 4.1 总线接口单元BIU, Bus Interface Unit</h3>
<p>总线接口单元由<strong>指令寄存器</strong>, <strong>指令指针IP</strong>, <strong>段寄存器</strong>, <strong>地址加法器</strong>, <strong>总线控制逻辑</strong>构成</p>
<p>总线接口单元的作用是管理8086与系统总线的接口, 负责处理器对存储器和外设进行访问<br />
例如从主存中读取指令, 从主存或外设读取数据, 向主存或外设写出数据</p>
<p>对外的8086处理器引脚由16位双向数据总线, 20位地址总线和若干控制总线组成</p>
<p><strong>取指</strong><br />
取指, 是处理器将指令代码从主存储器中取出并进入处理器内部的过程</p>
<p>8086处理器中, 指令在存储器中的地址由<strong>代码段寄存器CS</strong>和<strong>指令指针寄存器IP</strong>共同提供, 再由地址加法器得到20位存储器地址</p>
<p>总线接口单元BIU负责从存储器取出指令代码, 送入指令队列</p>
<h3 id="42-执行单元eu-execution-unit"><a class="markdownIt-Anchor" href="#42-执行单元eu-execution-unit"></a> 4.2 执行单元EU, Execution Unit</h3>
<p>执行单元由<strong>算术逻辑单元</strong>, <strong>标志寄存器</strong>, <strong>通用寄存器</strong>, <strong>进行指令译码的EU控制电路</strong>构成</p>
<p><strong>执行</strong>, <strong>译码</strong><br />
执行, 是处理器将指令代码翻译成它所代表的功能, 并发出有关控制信号实现这个功能的过程</p>
<p>8086处理器中, 执行单元EU从指令队列中获得预先取出的指令代码, 在EU控制电路中进行译码, 然后发出控制信号由算术逻辑单元ALU进行数据运算, 数据传送等操作</p>
<p>执行单元EU负责从存储器中取出数据</p>
<h2 id="5-8086的寄存器"><a class="markdownIt-Anchor" href="#5-8086的寄存器"></a> 5 8086的寄存器</h2>
<p><strong>寄存器</strong>, <strong>Register</strong><br />
寄存器是处理器内部的高速存储单元<br />
寄存器的作用是暂时存放程序执行过程中的代码</p>
<p>从应用的角度可将寄存器分为<strong>透明寄存器</strong>, <strong>可编程寄存器</strong></p>
<p><strong>透明寄存器</strong><br />
透明寄存器是程序员无法通过指令直接编程控制的寄存器</p>
<p>透明二字的英文是<strong>Transparency</strong><br />
该单词的意思是, 实际存在但从某个角度看却看不见</p>
<p><strong>可编程寄存器</strong><br />
可编程寄存器是程序员可以通过指令直接编程控制的寄存器</p>
<p>可编程寄存器又可以被分为<strong>通用寄存器</strong>, <strong>专用寄存器</strong></p>
<p>8086的所有可编程寄存器都是16位的</p>
<p><strong>通用寄存器</strong><br />
具有多种用途的寄存器</p>
<p><strong>专用寄存器</strong><br />
只能用于特定目的的寄存器<br />
例如<strong>标志寄存器</strong>, <strong>指令指针寄存器</strong>, <strong>段寄存器</strong></p>
<p>8086有8个通用寄存器, 4个段寄存器, 1个标志寄存器, 1个指令指针寄存器</p>
<h3 id="51-通用寄存器-generral-purpose-register"><a class="markdownIt-Anchor" href="#51-通用寄存器-generral-purpose-register"></a> 5.1 通用寄存器, Generral-Purpose Register</h3>
<table>
<thead>
<tr>
<th>名称</th>
<th>中英文含义</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>AX</td>
<td>累加器, Accumulator</td>
<td>算术, 逻辑运算, 与外设传送信息</td>
</tr>
<tr>
<td>BX</td>
<td>基址寄存器, Base</td>
<td>存放存储器地址</td>
</tr>
<tr>
<td>CX</td>
<td>计数器, Counter</td>
<td>作为循环操作等指令中的计数器</td>
</tr>
<tr>
<td>DX</td>
<td>数据寄存器, Data</td>
<td>存放数据, 存放外设端口地址</td>
</tr>
<tr>
<td>SI</td>
<td>源变址寄存器, Source Index</td>
<td>指向字符串或数组的源操作数</td>
</tr>
<tr>
<td>DI</td>
<td>目的变址寄存器, Destination Index</td>
<td>指向字符串或数组的目的操作数</td>
</tr>
<tr>
<td>BP</td>
<td>基址指针寄存器, Base Pointer</td>
<td>指向程序堆栈区域的数据</td>
</tr>
<tr>
<td>SP</td>
<td>堆栈指针寄存器, Stack Pointer</td>
<td>指向程序堆栈区域的顶部的数据</td>
</tr>
</tbody>
</table>
<p><strong>堆栈</strong><br />
堆栈是一个特殊的存储区域<br />
堆栈采用<strong>先进后出</strong>的操作方式来存取数据<br />
堆栈的作用是调用子程序时暂存数据, 传递参数, 存放局部变量; 临时保存数据</p>
<p>AX等16位寄存器, 可被分为两个8位寄存器<br />
对其中某8位的操作, 并不影响另外8位的数据</p>
<table>
<thead>
<tr>
<th>可分通用寄存器, 16位</th>
<th>高字节通用寄存器, 8位</th>
<th>低字节通用寄存器, 8位</th>
</tr>
</thead>
<tbody>
<tr>
<td>AX</td>
<td>AH</td>
<td>AL</td>
</tr>
<tr>
<td>BX</td>
<td>BH</td>
<td>BL</td>
</tr>
<tr>
<td>CX</td>
<td>CH</td>
<td>CL</td>
</tr>
<tr>
<td>DX</td>
<td>DH</td>
<td>DL</td>
</tr>
</tbody>
</table>
<h3 id="52-标志寄存器-flag-register"><a class="markdownIt-Anchor" href="#52-标志寄存器-flag-register"></a> 5.2 标志寄存器, Flag Register</h3>
<p>标志寄存器的作用是反映指令执行结果或控制指令执行形式<br />
标志寄存器共有16位, 其中只有9个位是真正起作用的, 其它的位透明<br />
一个位的0和1分别表示不同的一个状态</p>
<p>一些指令的执行结果会影响到标志寄存器中的某个位<br />
一些指令的执行需要结合标志寄存器的某个位</p>
<p>标志寄存器的9个标志, 分为<strong>状态标志</strong>, <strong>控制标志</strong><br />
状态标志有6个, 控制标志有3个</p>
<table>
<thead>
<tr>
<th>状态标志</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>CF</td>
<td>Carry Flag, 进位标志</td>
</tr>
<tr>
<td>PF</td>
<td>Parity Flag, 奇偶标志</td>
</tr>
<tr>
<td>AF</td>
<td>Adjust Flag, 调整标志</td>
</tr>
<tr>
<td>ZF</td>
<td>Zero Flag, 零标志</td>
</tr>
<tr>
<td>SF</td>
<td>Sign Flag, 符号标志</td>
</tr>
<tr>
<td>OF</td>
<td>Overflow Flag, 溢出标志</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>控制标志</th>
<th>解释</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>DF</td>
<td>Direction Flag, 方向标志</td>
<td>仅用于串操作指令, 控制地址的变化方向</td>
</tr>
<tr>
<td>IF</td>
<td>Interrupt-enable Flag, 中断标志</td>
<td>控制外部可屏蔽中断是否可以被处理器响应</td>
</tr>
<tr>
<td>TF</td>
<td>Trap Flag, 单步标志</td>
<td>控制处理器是否进入单步操作方式</td>
</tr>
</tbody>
</table>
<h3 id="53-指令指针寄存器-instruction-pointer"><a class="markdownIt-Anchor" href="#53-指令指针寄存器-instruction-pointer"></a> 5.3 指令指针寄存器, Instruction Pointer</h3>
<p>指令指针寄存器保存<strong>将要执行的指令在主存中的地址</strong></p>
<p>IP是一个专用寄存器, 会自动增量<br />
处理器每执行完一条指令, IP就加上该指令的字节数, 指向下一条指令, 实现程序的顺序执行</p>
<p>执行<strong>分支</strong>, <strong>调用</strong>等操作时, 需要修改IP<br />
IP无法被直接赋值修改, 需要<strong>执行控制转移指令</strong>或<strong>出现中断或异常</strong>来被处理器赋值</p>
<h3 id="54-段寄存器"><a class="markdownIt-Anchor" href="#54-段寄存器"></a> 5.4 段寄存器</h3>
<p><strong>段</strong><br />
将相关的代码或数据安排在一起, 就出现了一个段</p>
<table>
<thead>
<tr>
<th>段分为三类</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>代码段, Code Segment</td>
<td>存放程序中指令代码</td>
</tr>
<tr>
<td>数据段, Data Segment</td>
<td>存放当前运行程序所用数据</td>
</tr>
<tr>
<td>堆栈段, Stack Segment</td>
<td>指明程序使用的堆栈区域</td>
</tr>
</tbody>
</table>
<p>8086处理器中有4个段寄存器</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>CS</td>
<td>代码段寄存器, Code Segment</td>
</tr>
<tr>
<td>SS</td>
<td>堆栈段寄存器, Stack Segment</td>
</tr>
<tr>
<td>DS</td>
<td>数据段寄存器, Data Segment</td>
</tr>
<tr>
<td>ES</td>
<td>附加段寄存器, Extra Segment</td>
</tr>
</tbody>
</table>
<h2 id="6-8086的存储器组织"><a class="markdownIt-Anchor" href="#6-8086的存储器组织"></a> 6 8086的存储器组织</h2>
<h3 id="61-存储单元"><a class="markdownIt-Anchor" href="#61-存储单元"></a> 6.1 存储单元</h3>
<p>主存储器被分为一个个<strong>存储单元</strong><br />
每一个存储单元都有一个<strong>存储单元地址</strong><br />
每一个存储单元保存<strong>8位</strong>的数据</p>
<p><strong>位</strong>, <strong>bit</strong>, <strong>b</strong><br />
一个位可以保存一个二进制数<strong>0</strong>或者<strong>1</strong></p>
<p><strong>字节</strong>, <strong>byte</strong>, <strong>B</strong><br />
1B = 8b</p>
<p>主存以字节作为基本存储单位</p>
<h3 id="62-逻辑地址"><a class="markdownIt-Anchor" href="#62-逻辑地址"></a> 6.2 逻辑地址</h3>
<p><strong>物理地址</strong>, <strong>Physical Address</strong><br />
主存的存储单元的实际地址</p>
<p>物理地址从0开始, 直到处理器支持的最大存储单元<br />
n位地址, 共有2<sup>n</sup>个地址</p>
<p><strong>段基地址</strong>, <strong>段地址</strong><br />
8086共有20位地址总线, 地址总线连接着主存<br />
但8086的寄存器只有16位, 最多能指示2<sup>16</sup>=64KB大小的存储器, 范围是<strong>0000H~FFFFH</strong><br />
为了平衡两者, 人类<strong>将主存以64KB为单元</strong>, 对主存进行了划分<br />
每一个64KB单元同样有一个16位的地址, 该地址就是<strong>段基地址</strong></p>
<p>为了方便通过段地址和偏移地址来得到物理地址<br />
8086处理器规定了<strong>每一个64KB单元的起始存储单元的物理地址的低4位必须是0000</strong><br />
各段不能重叠, 但各段的大小可以小于64KB, 设置大小合适的段有利于制作一个体积小的程序</p>
<p><strong>逻辑地址</strong><br />
<code>逻辑地址 = 段地址 : 偏移地址</code></p>
<p><strong>偏移地址</strong>, <strong>offset</strong><br />
通过段地址和偏移地址获得物理地址的公式为<code>物理地址 = 段地址*10H + 偏移地址</code></p>
<h3 id="63-段的分类"><a class="markdownIt-Anchor" href="#63-段的分类"></a> 6.3 段的分类</h3>
<p>8086设计了4种类型的逻辑段</p>
<table>
<thead>
<tr>
<th>段分类</th>
<th>作用</th>
<th>段地址</th>
<th>偏移地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>代码段</td>
<td>存放程序的指令序列</td>
<td>CS</td>
<td>IP</td>
</tr>
<tr>
<td>堆栈段</td>
<td>确定堆栈所在的主存区域</td>
<td>SS</td>
<td>SP</td>
</tr>
<tr>
<td>数据段</td>
<td>存放当前运行程序所用的数据</td>
<td>DS</td>
<td>EA</td>
</tr>
<tr>
<td>附加段</td>
<td>附加的数据段, 可被用于保存数据</td>
<td>ES</td>
<td>EA</td>
</tr>
</tbody>
</table>
<p>程序的指令代码必须被安排在代码段, 否则将无法正常执行<br />
处理器利用CS获得当前代码段的段地址, IP保存代码段中指令的偏移地址<br />
处理器根据CS:IP取得下一条要执行的指令</p>
<p>程序使用的堆栈必须被安排在堆栈段<br />
处理器利用SS获得当前堆栈段的段地址, SP保存堆栈栈顶的偏移地址<br />
处理器根据SS:SP操作堆栈数据</p>
<p>一个程序可以使用多个数据段<br />
例如, 一个程序的主要数据存放在一个数据段, 只读的数据存放在另一个数据段, 动态分配的数据安排在第3个数据段</p>
<p>8086规定程序当前访问的数据默认安排在数据段, 应用中无须特别说明<br />
也需要将数据安排在其他段, 但应用中需要特别说明</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2021/03/05/TensorFlow-based-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="黄嘉玮">
      <meta itemprop="description" content="风物长宜放眼量">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="冰雹2009">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2021/03/05/TensorFlow-based-1/" class="post-title-link" itemprop="url">TensorFlow-based-1</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2021-03-05 16:54:25" itemprop="dateCreated datePublished" datetime="2021-03-05T16:54:25+08:00">2021-03-05</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Machine-learning/" itemprop="url" rel="index"><span itemprop="name">Machine-learning</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="tensorflow-based-1"><a class="markdownIt-Anchor" href="#tensorflow-based-1"></a> TensorFlow-based-1</h1>
<h2 id="1-安装"><a class="markdownIt-Anchor" href="#1-安装"></a> 1 安装</h2>
<h3 id="11-anaconda"><a class="markdownIt-Anchor" href="#11-anaconda"></a> 1.1 Anaconda</h3>
<p>下载并安装<a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual">Anaconda</a></p>
<h3 id="12-pycharm"><a class="markdownIt-Anchor" href="#12-pycharm"></a> 1.2 PyCharm</h3>
<p>下载并安装<a target="_blank" rel="noopener" href="https://www.jetbrains.com/pycharm/">PyCharm</a></p>
<p>建议安装免费的Community版本</p>
<h3 id="13-command"><a class="markdownIt-Anchor" href="#13-command"></a> 1.3 command</h3>
<p>打开<strong>Anaconda Prompt</strong>, 输入<code>pip install tensorflow</code></p>
<h3 id="14-测试"><a class="markdownIt-Anchor" href="#14-测试"></a> 1.4 测试</h3>
<p>在<strong>Anaconda Prompt</strong>中进入Python, 并输入以下代码进行测试</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line">A = tf.constant([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">B = tf.constant([[<span class="number">5</span>, <span class="number">6</span>], [<span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line">C = tf.matmul(A, B)</span><br><span class="line">print(C)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">tf.Tensor(</span></span><br><span class="line"><span class="string">[[19 22]</span></span><br><span class="line"><span class="string">[43 50]], shape=(2, 2), dtype=int32)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="2-求导"><a class="markdownIt-Anchor" href="#2-求导"></a> 2 求导</h2>
<p>TensorFlow提供了强大的<strong>自动求导机制</strong></p>
<h3 id="21-一元函数"><a class="markdownIt-Anchor" href="#21-一元函数"></a> 2.1 一元函数</h3>
<p>以下代码展示了<br />
计算函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>x</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">y(x)=x^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">x=3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">3</span></span></span></span>时的导数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow.compat.v1 <span class="keyword">as</span> tf</span><br><span class="line">tf.enable_eager_execution()</span><br><span class="line"></span><br><span class="line">x = tf.get_variable(<span class="string">&#x27;x&#x27;</span>, shape=[<span class="number">1</span>], initializer = tf.constant_initializer(<span class="number">3.</span>))</span><br><span class="line"><span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:</span><br><span class="line">    y = tf.square(x)</span><br><span class="line">y_grad = tape.gradient(y, x)</span><br><span class="line">print([y.numpy(), y_grad.numpy()])</span><br><span class="line"></span><br><span class="line"><span class="comment"># [array([9.], dtype=float32), array([6.], dtype=float32)]</span></span><br></pre></td></tr></table></figure>
<p>x是一个<strong>变量</strong><br />
使用<code>tf.get_variable()</code>来声明<br />
使用该函数中的<code>initializer</code>参数来指定所使用的的初始化器<code>tf.constant_initializer(3.)</code>, 将变量x初始化为float32类型的<code>3.</code></p>
<p>y是一个<strong>张量</strong><br />
变量能默认被tf的自动求导机制做求导, 而张量默认不能</p>
<p><code>tf.GradientTape()</code>是一个自动求导的记录器, 在其中的变量和计算步骤都会被自动记录<br />
变量x和<code>y = tf.square(x)</code>都被它记录了<br />
所以可以通过<code>y_grad = tape.gradient(y, x)</code>来求<strong>张量y</strong>对<strong>变量x</strong>的导数</p>
<h3 id="22-偏导数"><a class="markdownIt-Anchor" href="#22-偏导数"></a> 2.2 偏导数</h3>
<p>以下代码展示了<br />
计算函数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><mi mathvariant="normal">∣</mi><mi>X</mi><mi>w</mi><mo>+</mo><mi>b</mi><mo>−</mo><mi>y</mi><msup><mi mathvariant="normal">∣</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">L(w, b)=|Xw+b-y|^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span>在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">w=(1, 2)^{T}, b=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0913309999999998em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8413309999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>时, 分别对<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>w</mi></mrow><annotation encoding="application/x-tex">w</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">b</span></span></span></span>的偏导数<br />
其中<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>3</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>4</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mo separator="true">,</mo><mi>y</mi><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>2</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">X = \begin{bmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{bmatrix}, y = \begin{bmatrix} 1 \\ 2 \end{bmatrix}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:0.5em;"></span><span class="arraycolsep" style="width:0.5em;"></span><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">4</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span></span></span></span></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">X = tf.constant([[<span class="number">1.</span>, <span class="number">2.</span>], [<span class="number">3.</span>, <span class="number">4.</span>]])</span><br><span class="line">y = tf.constant([[<span class="number">1.</span>], [<span class="number">2.</span>]])</span><br><span class="line">w = tf.get_variable(<span class="string">&#x27;w&#x27;</span>, shape=[<span class="number">2</span>, <span class="number">1</span>], initializer=tf.constant_initializer([[<span class="number">1.</span>], [<span class="number">2.</span>]]))</span><br><span class="line">b = tf.get_variable(<span class="string">&#x27;b&#x27;</span>, shape=[<span class="number">1</span>], initializer=tf.constant_initializer([<span class="number">1.</span>]))</span><br><span class="line"><span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape:</span><br><span class="line">    L = <span class="number">0.5</span> * tf.reduce_sum(tf.square(tf.matmul(X, w)+b-y))</span><br><span class="line">w_grad, b_grad = tape.gradient(L, [w, b])</span><br><span class="line">print([L.numpy(), w_grad.numpy(), b_grad.numpy()])</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">[62.5, array([[35.],</span></span><br><span class="line"><span class="string">       [50.]], dtype=float32), array([15.], dtype=float32)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><code>tf.square()</code>对输入张量的每一个元素求平方, 不改变张量形状</p>
<p><code>tf.reduce_sum()</code>对输入张量的所有元素求和, 输出一个形状为空的纯良张量<br />
可以通过axis参数来指定求和的维度, 不指定则默认对所有元素求和</p>
<p>上方代码的结果为</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mn>62.5</mn><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>w</mi></mrow></mfrac><msub><mi mathvariant="normal">∣</mi><mrow><mi>w</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>=</mo><mrow><mo fence="true">[</mo><mtable rowspacing="0.15999999999999992em" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>35</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>50</mn></mstyle></mtd></mtr></mtable><mo fence="true">]</mo></mrow><mspace linebreak="newline"></mspace><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>L</mi><mo stretchy="false">(</mo><mi>w</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mi>b</mi></mrow></mfrac><msub><mi mathvariant="normal">∣</mi><mrow><mi>w</mi><mo>=</mo><mo stretchy="false">(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><msup><mo stretchy="false">)</mo><mi>T</mi></msup><mo separator="true">,</mo><mi>b</mi><mo>=</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">L((1, 2)^{T}, 1) = 62.5 \\
\frac{\partial L(w, b)}{\partial w} |_{w=(1, 2)^{T}, b=1} = \begin{bmatrix} 35 \\ 50 \end{bmatrix} \\
\frac{\partial L(w, b)}{\partial b} |_{w=(1, 2)^{T}, b=1} = 15
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1413309999999999em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mopen">(</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8913309999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">6</span><span class="mord">2</span><span class="mord">.</span><span class="mord">5</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34479999999999994em;"><span style="top:-2.502935em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mrel mtight">=</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7740928571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3720649999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.40003em;vertical-align:-0.95003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">[</span></span><span class="mord"><span class="mtable"><span class="col-align-c"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.45em;"><span style="top:-3.61em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">3</span><span class="mord">5</span></span></span><span style="top:-2.4099999999999997em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">5</span><span class="mord">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9500000000000004em;"><span></span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">]</span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">b</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord" style="margin-right:0.05556em;">∂</span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord">∣</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34479999999999994em;"><span style="top:-2.502935em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="mrel mtight">=</span><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mtight">2</span><span class="mclose mtight"><span class="mclose mtight">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7740928571428571em;"><span style="top:-2.786em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3720649999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">5</span></span></span></span></span></p>
<h2 id="3-线性回归"><a class="markdownIt-Anchor" href="#3-线性回归"></a> 3 线性回归</h2>
<p>某城市在2013年-2017年的房价</p>
<table>
<thead>
<tr>
<th>年份</th>
<th>2013</th>
<th>2014</th>
<th>2015</th>
<th>2016</th>
<th>2017</th>
</tr>
</thead>
<tbody>
<tr>
<td>房价</td>
<td>12000</td>
<td>14000</td>
<td>15000</td>
<td>16500</td>
<td>17500</td>
</tr>
</tbody>
</table>
<p>对数据进行线性回归<br />
求解<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow><mi>a</mi><mo separator="true">,</mo><mi>b</mi></mrow></msub><mi>L</mi><mo stretchy="false">(</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo><mo>=</mo><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mo stretchy="false">(</mo><mi>a</mi><msub><mi>x</mi><mi>i</mi></msub><mo>+</mo><mi>b</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">min_{a, b}L(a, b) = \sum^{n}_{i=1}(ax_{i}+b-y_{i})^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">i</span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">a</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">b</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord mathdefault">L</span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.104002em;vertical-align:-0.29971000000000003em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.804292em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29971000000000003em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">a</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<h3 id="31-定义数据"><a class="markdownIt-Anchor" href="#31-定义数据"></a> 3.1 定义数据</h3>
<p>对数据进行归一化操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">X_raw = np.array([<span class="number">2013</span>, <span class="number">2014</span>, <span class="number">2015</span>, <span class="number">2016</span>, <span class="number">2017</span>])</span><br><span class="line">y_raw = np.array([<span class="number">12000</span>, <span class="number">14000</span>, <span class="number">15000</span>, <span class="number">16500</span>, <span class="number">17500</span>])</span><br><span class="line"></span><br><span class="line">X = (X_raw - X_raw.<span class="built_in">min</span>()) / (X_raw.<span class="built_in">max</span>() - X_raw.<span class="built_in">min</span>())</span><br><span class="line">y = (y_raw - y_raw.<span class="built_in">min</span>()) / (y_raw.<span class="built_in">max</span>() - y_raw.<span class="built_in">min</span>())</span><br></pre></td></tr></table></figure>
<h3 id="32-梯度下降法"><a class="markdownIt-Anchor" href="#32-梯度下降法"></a> 3.2 梯度下降法</h3>
<table>
<thead>
<tr>
<th>梯度下降法的步骤</th>
</tr>
</thead>
<tbody>
<tr>
<td>求f(x)关于x的梯度<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\nabla f(x_{k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td>求<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><msub><mi>x</mi><mi>k</mi></msub><mo>−</mo><mi>γ</mi><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><msub><mi>x</mi><mi>k</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">x_{k+1}=x_{k}-\gamma\nabla f(x_{k})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.73333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05556em;">γ</span><span class="mord">∇</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></td>
</tr>
<tr>
<td><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>←</mo><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k \larr k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">←</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span></td>
</tr>
</tbody>
</table>
<p>tensorflow的动态图模式提供了一系列对于深度学习来说非常重要的功能</p>
<p><code>tape.gradient(ys, xs)</code>计算梯度</p>
<p><code>optimizer.apply_gradients(grads_and_vars)</code>更新模型参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">X = tf.constant(X)</span><br><span class="line">y = tf.constant(y)</span><br><span class="line">a = tf.get_variable(<span class="string">&#x27;a&#x27;</span>, dtype=tf.float32, shape=[], initializer=tf.zeros_initializer)</span><br><span class="line">b = tf.get_variable(<span class="string">&#x27;b&#x27;</span>, dtype=tf.float32, shape=[], initializer=tf.zeros_initializer)</span><br><span class="line">variable = [a, b]</span><br><span class="line"></span><br><span class="line">num_epoch = <span class="number">10000</span></span><br><span class="line">optimizer = tf.train.GradientDescentOptimizer(learning_rate=<span class="number">1e-3</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(num_epoch):</span><br><span class="line">    <span class="keyword">with</span> tf.GradientTape() <span class="keyword">as</span> tape: <span class="comment"># 记录损失函数的梯度信息</span></span><br><span class="line">        y_pred = a * X + b</span><br><span class="line">        loss = <span class="number">0.5</span> * tf.reduce_sum(tf.square(y_pred - y))</span><br><span class="line">    grads = tape.gradient(loss, variables) <span class="comment"># 计算损失函数关于自变量的梯度</span></span><br><span class="line">    optimizer.apply_gradients(grads_and_vars=<span class="built_in">zip</span>(grads, variables)) <span class="comment"># 根据梯度更新参数</span></span><br></pre></td></tr></table></figure>
<p><code>tf.train.GradientDescentOptimizer(learning_rate=1e-3)</code>声明了一个梯度下降<strong>优化器</strong>, 其学习率为<code>1e-3</code><br />
优化器可以根据计算出的求导结果来更新模型参数, 并通过调用其<code>apply_gradients()</code>方法来最小化某个特定的损失函数</p>
<p><code>optimizer.apply_gradients()</code>需要参数<code>grads_and_vars</code>, 即<strong>待更新的变量</strong>及<strong>损失函数关于这些变量的偏导数</strong><br />
上方代码传入了一个Python列表, 列表中的每一个元素都是一个<code>(变量的偏导数, 变量)</code>对, 即<code>[(grad_w, w), (grad_b, b)]</code></p>
<p>通过<code>grads = tape.gradient(loss, variables)</code>求出tape中记录的<code>loss</code>关于<code>variables = [w, b]</code>中每个变量的偏导数, 即<code>grads = [grad_w, grad_b]</code></p>
<p>使用Python的<code>zip()</code>将<code>grads = [grad_w, grad_b]</code>和<code>vars = [w, b]</code>拼装在一起, 从而组合出所需的参数</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">黄嘉玮</p>
  <div class="site-description" itemprop="description">风物长宜放眼量</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">6</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fas fa-store"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">黄嘉玮</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/katex.min.css">
  <script src="//cdn.jsdelivr.net/npm/katex@0/dist/contrib/copy-tex.min.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0/dist/contrib/copy-tex.min.css">


  

</body>
</html>
